<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Google Contacts</title>
    <!-- CSS Styling -->
    <link rel="stylesheet" th:href="@{/css/styles.css}" />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
  </head>
  <body>
    <div class="app-container">
      <!-- Main Content -->
      <main class="main-content">
        <header class="main-header">
          <h1>Contacts</h1>
          <div class="header-actions">
            <button id="addContactBtn" class="btn btn-primary">
              <span class="material-symbols-outlined">add</span> Add Contact
            </button>
          </div>
        </header>

        <!-- Content Container -->
        <div class="content-container">
          <!-- Contact List -->
          <div class="contact-list" id="contactList">
            <div
              class="contact-item"
              th:each="person : ${contacts}"
              th:attr="data-id=${person.resourceName}">
              <div class="contact-avatar">
                <span
                  class="avatar-text"
                  th:text="${#lists.isEmpty(person.names) ? '?' : person.names[0].givenName.substring(0,1) + person.names[0].familyName.substring(0,1)}">
                  ?
                </span>
              </div>
              <div class="contact-info">
                <h3
                  class="contact-name"
                  th:text="${#lists.isEmpty(person.names) ? 'No Name' : person.names[0].displayName}">
                  Contact Name
                </h3>
                <p
                  class="contact-phone"
                  th:text="${#lists.isEmpty(person.phoneNumbers) ? '' : person.phoneNumbers[0].value}">
                  Phone
                </p>
              </div>
              <div class="contact-actions">
                <button
                  class="btn-icon edit-contact"
                  th:attr="data-id=${person.resourceName}">
                  <span class="material-symbols-outlined">edit</span>
                </button>
                <button
                  class="btn-icon delete-contact"
                  th:attr="data-id=${person.resourceName}">
                  <span class="material-symbols-outlined">delete</span>
                </button>
              </div>
            </div>
          </div>
        </div>
      </main>
    </div>

    <!-- Modal for Add/Edit Contact -->
    <div id="contactModal" class="modal">
      <div class="modal-content form-modal">
        <div class="modal-header">
          <h2 id="modalTitle">Add New Contact</h2>
          <button id="closeModal" class="close-btn">
            <span class="material-symbols-outlined">close</span>
          </button>
        </div>
        <div class="modal-body">
          <form
            id="contactForm"
            th:action="@{/api/contacts}"
            th:object="${person}"
            method="post">
            <input type="hidden" id="resourceName" th:field="*{resourceName}" />

            <div class="form-row">
              <div class="form-group">
                <label for="givenName">First Name</label>
                <input
                  type="text"
                  id="givenName"
                  name="names[0].givenName"
                  th:field="*{names[0].givenName}"
                  required />
              </div>
              <div class="form-group">
                <label for="familyName">Last Name</label>
                <input
                  type="text"
                  id="familyName"
                  name="names[0].familyName"
                  th:field="*{names[0].familyName}"
                  required />
              </div>
            </div>

            <!-- Phone Field -->
            <div class="form-group">
              <label for="phoneValue">Phone</label>
              <input
                type="tel"
                id="phoneValue"
                name="phoneNumbers[0].value"
                th:field="*{phoneNumbers[0].value}" />
            </div>

            <div class="form-actions">
              <button type="button" id="cancelBtn" class="btn btn-secondary">
                Cancel
              </button>
              <button type="submit" class="btn btn-primary">
                Save Contact
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Contact Details Modal -->
    <div id="detailsModal" class="modal">
      <div class="modal-content details-modal">
        <div class="modal-header">
          <h2>Contact Details</h2>
          <button id="closeDetailsModal" class="close-btn">
            <span class="material-symbols-outlined">close</span>
          </button>
        </div>
        <div class="modal-body">
          <div class="contact-details">
            <div class="contact-header">
              <div class="contact-avatar large">
                <span class="avatar-text" id="detailsInitials">?</span>
              </div>
              <div class="contact-title">
                <h2 class="contact-name" id="detailsName">Contact Name</h2>
              </div>
            </div>

            <div class="contact-info-section">
              <h3>Contact Information</h3>
              <div class="info-grid">
                <div class="info-item">
                  <span class="material-symbols-outlined">phone</span>
                  <div>
                    <p class="info-label">Phone</p>
                    <p class="info-value" id="detailsPhone">Phone</p>
                  </div>
                </div>
              </div>
            </div>

            <div class="contact-actions-container">
              <button id="editFromDetailsBtn" class="btn btn-secondary">
                <span class="material-symbols-outlined">edit</span> Edit
              </button>
              <button id="deleteFromDetailsBtn" class="btn btn-danger">
                <span class="material-symbols-outlined">delete</span> Delete
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div id="deleteModal" class="modal">
      <div class="modal-content delete-modal">
        <div class="modal-header">
          <h2>Delete Contact</h2>
          <button id="closeDeleteModal" class="close-btn">
            <span class="material-symbols-outlined">close</span>
          </button>
        </div>
        <div class="modal-body">
          <p>
            Are you sure you want to delete this contact? This action cannot be
            undone.
          </p>
          <div class="form-actions">
            <button id="cancelDeleteBtn" class="btn btn-secondary">
              Cancel
            </button>
            <button id="confirmDeleteBtn" class="btn btn-danger">Delete</button>
          </div>
        </div>
      </div>
    </div>

    <!-- JavaScript -->
    <script th:src="@{/js/script.js}"></script>
  </body>
</html>
